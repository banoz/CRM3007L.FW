# I2C (IIC) Register Map Documentation

This document describes the I2C register map inferred from the provided code snippet for a coffee machine control system. The `n_DAT` array acts as the register bank.

## Register Map

| Address | Name/Description              | Type                | Bits/Format       | Details |
|---------|-------------------------------|---------------------|-------------------|---------|
| 0x00   | Switch States                | Read-only (status) | Bitfield (uint8_t) | - Bit 0: Unused/reserved.<br>- Bit 1: Power button.<br>- Bit 2: S1 button.<br>- Bit 3: S2 button.<br>- Bit 4: Steam knob switch.<br>- Bits 5-7: Unused/reserved. |
| 0x01   | Coffee Temperature (Low Byte)| Read-only (status) | uint8_t          | Low byte of 16-bit coffee boiler temperature (°C × 10). Little-endian with 0x02. Example: 950 (0x03B6) = 95.0°C. Derived from NTC sensor. |
| 0x02   | Coffee Temperature (High Byte)| Read-only (status)| uint8_t          | High byte of coffee temperature. |
| 0x03   | Steam Temperature (Low Byte) | Read-only (status) | uint8_t          | Low byte of 16-bit steam boiler temperature (°C × 10). Little-endian with 0x04. |
| 0x04   | Steam Temperature (High Byte)| Read-only (status) | uint8_t          | High byte of steam temperature. |
| 0x05   | Unused/Reserved              | -                  | -                | |
| 0x06   | PSM counter                  | Read-only (status) | uint8_t          | |
| 0x07   | Unused/Reserved              | -                  | -                | |
| 0x08   | Controls                     | Write-only (command)| Bitfield (uint8_t)| - Bit 0: Status LED.<br>- Bit 1: Power button LED.<br>- Bit 2: S1 button LED.<br>- Bit 3: S2 button LED.<br>- Bits 4-6: Unused.<br>- Bit 7: Reset PSM counter to 0 if set. |
| 0x09   | Valves                       | Write-only (command)| Bitfield (uint8_t)| - Bit 0: K3 - Coffee valve.<br>- Bit 1: K2 - Steam valve.<br>- Bit 2: K1 - 3WV.<br>- Bits 3-7: Unused. |
| 0x0A   | Pump Power                   | Write-only (command)| uint8_t (0-255)  | Sets PSM for pump control. |
| 0x0B   | Coffee Power                 | Write-only (command)| uint8_t (0-99)   | Manual power for coffee heater when setpoint is 0. |
| 0x0C   | Steam Power                  | Write-only (command)| uint8_t (0-99)   | PWM duty cycle for steam heater. |
| 0x0D   | Coffee Setpoint (Low Byte)   | Write-only (command)| uint8_t          | Low byte of coffee boiler target temperature (°C × 10). Little-endian with 0x0E. |
| 0x0E   | Coffee Setpoint (High Byte)  | Write-only (command)| uint8_t          | High byte of coffee boiler target temperature. |
| 0x0F   | PID Kp                       | Write-only (command)| uint8_t          | Proportional gain for coffee PID (scaled by 100). |
| 0x10   | PID Ki                       | Write-only (command)| uint8_t          | Integral gain for coffee PID (scaled by 100). |
| 0x11   | PID Kd                       | Write-only (command)| uint8_t          | Derivative gain for coffee PID (scaled by 100). |

## Additional Notes
- **I2C Address**: 0x10.
- **Endianness**: Little-endian for multi-byte values.
- **Update**: Registers updated every 10 ms.
- **Directions**: Status (read) vs. command (write).
- **Units**: Temperatures in °C × 10.
- **Example**: 950 represents 95.0°C; coffee heating is safety-limited to 1200 (120°C) in `set_coffee_power()`, so higher setpoints still stop heating once the limit is reached.

generated by Grok
